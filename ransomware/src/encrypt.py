import os
from sys import argv
from collections import deque
from typing import Iterable
from mykeys import get_AES_random_key


def all_files(full_path_folder: str) -> Iterable:
    '''Returns a list(deque) with all the files in
    the given folder.'''
    list_of_all_files = deque()
    try:

        for root, __, files in os.walk(full_path_folder):
            for file in files:
                list_of_all_files.append(os.path.join(root, file))

        return list_of_all_files

    except FileNotFoundError:
        print(f"The folder '{full_path_folder}' does not exist.")
    except PermissionError:
        print(f"Without permission to access '{full_path_folder}'.")

    return list_of_all_files


print_iterable = lambda it: list(map(print, it))


if __name__ == '__main__':

    TARGET = None
    if len(argv) == 2 and argv[1] == 'test':
        from dotenv import load_dotenv
        load_dotenv()
        TARGET = os.getenv('TARGET')
    TARGET = '' if TARGET == None else TARGET

    print('target:', TARGET)

    files = all_files(TARGET)
    print_iterable(files)
    print(get_AES_random_key())
